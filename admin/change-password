<?php
session_start();

class PasswordChanger {
    private $con;

    public function __construct($dbConnection) {
        $this->con = $dbConnection;
    }

    public function changePassword($admid, $cpassword, $newpassword) {
        $cpassword = md5($cpassword);
        $newpassword = md5($newpassword);

        $query = mysqli_query($this->con, "SELECT ID FROM tbladmin WHERE ID='$admid' AND Password='$cpassword'");
        $row = mysqli_fetch_array($query);

        if ($row > 0) {
            $ret = mysqli_query($this->con, "UPDATE tbladmin SET Password='$newpassword' WHERE ID='$admid'");
            return 'Your password has been successfully changed.';
        } else {
            return 'Your current password is wrong.';
        }
    }
}
